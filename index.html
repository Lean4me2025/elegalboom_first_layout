<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>eLegalBoom — Document Request</title>
  <style>
    :root {
      --bg: #f7f7fb;
      --panel: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --accent: #0b74ff;
      --border: #e5e7eb;
      --accent-hover: #095ed0;
      --shadow: 0 8px 24px rgba(0,0,0,.06);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font: 16px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji;
    }
    .container {
      max-width: 1040px;
      margin: 28px auto 72px;
      padding: 24px;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: var(--shadow);
    }
    h1 { font-size: 34px; margin: 0 0 6px; }
    .sub { color: var(--muted); margin: 0 0 18px; }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px 18px;
    }
    .full { grid-column: 1 / -1; }
    label {
      font-size: 13px;
      color: var(--muted);
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
    }
    input, select, textarea {
      width: 100%;
      padding: 12px 11px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #fff;
      font: inherit;
    }
    textarea { height: 96px; resize: vertical; }
    .row { display: contents; }
    .actions {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      margin-top: 8px;
    }
    button {
      padding: 12px 18px;
      background: var(--accent);
      color: #fff;
      border: 0;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
    }
    button:hover { background: var(--accent-hover); }
    .disclaimer {
      text-align: center;
      color: var(--muted);
      font-size: 13px;
    }
    .pill {
      display: inline-block;
      padding: 2px 8px;
      border: 1px solid var(--border);
      border-radius: 999px;
      color: var(--muted);
      font-size: 12px;
    }
    .radio-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .radio-card {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      display: flex;
      gap: 10px;
      align-items: flex-start;
      background: #fff;
    }
    .sr {
      position: absolute !important;
      left: -9999px !important;
    }
  </style>
</head>
<body>
  <main class="container">
    <header>
      <h1>Request Your Document</h1>
      <p class="sub">Fast, accurate, affordable. Human‑reviewed. Delivered to your inbox.</p>
      <p class="pill">Config: set your Supabase URL & anon key at the bottom of this file.</p>
    </header>

    <form id="intakeForm" autocomplete="on">
      <section class="grid full">
        <div>
          <label for="first_name">First Name</label>
          <input id="first_name" name="first_name" required />
        </div>
        <div>
          <label for="last_name">Last Name</label>
          <input id="last_name" name="last_name" required />
        </div>
        <div>
          <label for="email">Email</label>
          <input id="email" name="email" type="email" required />
        </div>
        <div>
          <label for="phone">Phone (optional)</label>
          <input id="phone" name="phone" />
        </div>
      </section>

      <h3>Business / Address</h3>
      <section class="grid">
        <div class="full">
          <label for="business_name">Business / Entity Name (optional)</label>
          <input id="business_name" name="business_name" />
        </div>
        <div class="full">
          <label for="address">Street</label>
          <input id="address" name="address" />
        </div>
        <div>
          <label for="city">City</label>
          <input id="city" name="city" />
        </div>
        <div>
          <label for="state">State</label>
          <select id="state" name="state">
            <option value="">Select…</option>
            <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option>
            <option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option>
            <option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option>
            <option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option>
            <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option>
            <option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option>
            <option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option>
            <option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option>
            <option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option>
            <option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
            <option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option>
            <option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option>
            <option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option>
            <option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option>
            <option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option>
            <option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option>
            <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
          </select>
        </div>
        <div>
          <label for="zip">ZIP</label>
          <input id="zip" name="zip" />
        </div>
        <div>
          <label for="governing_state">Governing State (if different)</label>
          <input id="governing_state" name="governing_state" placeholder="Defaults to Address State" />
        </div>
        <div>
          <label for="preferred_deadline">Preferred Deadline</label>
          <input id="preferred_deadline" name="preferred_deadline" type="date" />
        </div>
      </section>

      <h3>What do you need?</h3>
      <section class="grid">
        <div>
          <label for="doc_type">Document Type</label>
          <select id="doc_type" name="doc_type" required>
            <option value="">Select…</option>
            <option value="LLC">LLC Formation</option>
            <option value="Partnership">Partnership Agreement</option>
            <option value="NDA">Non‑Disclosure Agreement</option>
            <option value="Operating Agreement">Operating Agreement</option>
            <option value="Bylaws">Corporate Bylaws</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div>
          <label for="urgency">Urgency</label>
          <select id="urgency" name="urgency" required>
            <option value="">Select…</option>
            <option value="Normal">Normal (2–3 days)</option>
            <option value="Rush">Rush (24 hours)</option>
          </select>
        </div>
        <div class="full">
          <label for="details">Details (key facts, special terms)</label>
          <textarea id="details" name="details" placeholder="Anything we should know to draft accurately…"></textarea>
        </div>
      </section>

      <h3>Parties (add up to 4)</h3>
      <section class="grid">
        <div>
          <label for="party1_name">Party 1 Name</label>
          <input id="party1_name" name="party1_name" />
        </div>
        <div>
          <label for="party1_role">Role</label>
          <input id="party1_role" name="party1_role" placeholder="Member, Partner, Disclosing…" />
        </div>
        <div>
          <label for="party1_email">Email (optional)</label>
          <input id="party1_email" name="party1_email" type="email" />
        </div>

        <div>
          <label for="party2_name">Party 2 Name</label>
          <input id="party2_name" name="party2_name" />
        </div>
        <div>
          <label for="party2_role">Role</label>
          <input id="party2_role" name="party2_role" />
        </div>
        <div>
          <label for="party2_email">Email (optional)</label>
          <input id="party2_email" name="party2_email" type="email" />
        </div>

        <div>
          <label for="party3_name">Party 3 Name</label>
          <input id="party3_name" name="party3_name" />
        </div>
        <div>
          <label for="party3_role">Role</label>
          <input id="party3_role" name="party3_role" />
        </div>
        <div>
          <label for="party3_email">Email (optional)</label>
          <input id="party3_email" name="party3_email" type="email" />
        </div>

        <div>
          <label for="party4_name">Party 4 Name</label>
          <input id="party4_name" name="party4_name" />
        </div>
        <div>
          <label for="party4_role">Role</label>
          <input id="party4_role" name="party4_role" />
        </div>
        <div>
          <label for="party4_email">Email (optional)</label>
          <input id="party4_email" name="party4_email" type="email" />
        </div>
      </section>

      <h3>How do you want to file?</h3>
      <section class="radio-row">
        <label class="radio-card">
          <input class="sr" type="radio" name="file_option" value="self" checked />
          <div><strong>I will download, sign, and file myself.</strong><br><span class="sub">(No service charge)</span></div>
        </label>
        <label class="radio-card">
          <input class="sr" type="radio" name="file_option" value="efile" />
          <div><strong>Please have eLegalBoom file for me.</strong><br><span class="sub">(Service fee TBD)</span></div>
        </label>
      </section>

      <div class="actions">
        <label class="full disclaimer">
          <input type="checkbox" id="disclaimer" required />
          I understand eLegalBoom provides AI‑assisted document preparation with human QC and is not a law firm, nor does it provide legal advice.
        </label>
      </div>

      <div class="actions">
        <span class="pill" id="order_hint"></span>
        <button type="submit">Submit Request</button>
      </div>
    </form>
  </main>

  <!-- Supabase client -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
  <script>
    // 🚨 Replace these two with YOUR real values (Project Settings → API → Project URL / anon public key)
    const SUPABASE_URL = "YOUR_SUPABASE_URL";
    const SUPABASE_ANON_KEY = "YOUR_SUPABASE_ANON_KEY";

    const { createClient } = supabase;
    const db = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Small helper: generate an order id like ELB-YYYYMMDD-XXXX
    function generateOrderId() {
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const day = String(d.getDate()).padStart(2,'0');
      const rand = Math.floor(Math.random()*9000 + 1000);
      return `ELB-${y}${m}${day}-${rand}`;
    }

    document.getElementById('intakeForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = Object.fromEntries(formData.entries());

      // Normalize fields
      data.governing_state = data.governing_state || data.state || null;
      data.created_at = new Date().toISOString();
      data.order_id = generateOrderId();

      // Show hint
      document.getElementById('order_hint').textContent = `Order: ${data.order_id}`;

      console.log('[eLegalBoom] submit payload →', data);

      // Insert
      const { error } = await db.from('requests').insert([data]);

      if (error) {
        console.error('[eLegalBoom] insert error →', error);
        alert('Error submitting request: ' + (error.message || 'unknown error'));
        return;
      }

      alert('Request submitted successfully!\\nOrder: ' + data.order_id);
      e.target.reset();
      document.getElementById('order_hint').textContent = '';
    });
  </script>
</body>
</html>
